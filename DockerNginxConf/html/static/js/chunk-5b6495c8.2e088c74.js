(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5b6495c8"],{"30c4":function(t,e,i){},"3cdc":function(t,e,i){"use strict";i("55dd");var a=i("5530"),o=(i("96cf"),i("1da1")),s=i("7e1e"),r=i("cf45"),n=(i("6762"),i("2fdb"),i("4360"));function l(t){if(t&&t instanceof Array&&t.length>0){var e=n["a"].getters&&n["a"].getters.roles,i=t,a=e.some((function(t){return i.includes(t)}));return!!a}return!1}var c=r["a"].parseTime;e["a"]={data:function(){return{data:[],sort:[],page:0,size:10,total:0,url:"",params:{},query:{},time:50,isAdd:!1,loading:!0,delLoading:!1,delAllLoading:!1,dialog:!1,form:{},resetForm:{},title:""}},methods:{parseTime:c,checkPermission:l,init:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.beforeInit();case 2:if(t.sent){t.next=4;break}return t.abrupt("return");case 4:return t.abrupt("return",new Promise((function(t,i){e.loading=!0,Object(s["a"])(e.url,e.getQueryParame()).then((function(i){e.total=i.data.total,e.data=i.data.records,setTimeout((function(){e.loading=!1}),e.time),t(i)})).catch((function(t){e.loading=!1,i(t)}))})));case 5:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),beforeInit:function(){return!0},getQueryParame:function(){return Object(a["a"])(Object(a["a"])({page:this.page,size:this.size,sort:this.sort},this.query),this.params)},pageChange:function(t){this.page=t-1,this.init()},sizeChange:function(t){this.page=0,this.size=t,this.init()},dleChangePage:function(t){void 0===t&&(t=1),this.data.length===t&&0!==this.page&&(this.page=this.page-1)},toQuery:function(){this.page=0,this.init()},submitSuccessNotify:function(){this.$notify({title:"提交成功",type:"success",duration:2500})},addSuccessNotify:function(){this.$notify({title:"新增成功",type:"success",duration:2500})},editSuccessNotify:function(){this.$notify({title:"编辑成功",type:"success",duration:2500})},delSuccessNotify:function(){this.$notify({title:"删除成功",type:"success",duration:2500})},notify:function(t,e){this.$notify({title:t,type:e,duration:2500})},beforeDelMethod:function(){return!0},delMethod:function(t){var e=this;this.beforeDelMethod()&&(this.delLoading=!0,this.crudMethod.del(t).then((function(){e.delLoading=!1,e.$refs[t].doClose(),e.dleChangePage(),e.delSuccessNotify(),e.afterDelMethod(),e.init()})).catch((function(){e.delLoading=!1,e.$refs[t].doClose()})))},afterDelMethod:function(){},beforeDelAllMethod:function(){var t=this;this.$confirm("你确定删除选中的数据吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.delAllMethod()}))},delAllMethod:function(){var t=this;this.delAllLoading=!0;for(var e=this.$refs.table.selection,i=[],a=0;a<e.length;a++)i.push(e[a].id);this.crudMethod.delAll(i).then((function(){t.delAllLoading=!1,t.dleChangePage(i.length),t.init(),t.$notify({title:"删除成功",type:"success",duration:2500})})).catch((function(){t.delAllLoading=!1}))},beforeShowAddForm:function(){},showAddFormDialog:function(){this.isAdd=!0,this.resetForm=JSON.parse(JSON.stringify(this.form)),this.beforeShowAddForm(),this.dialog=!0},beforeShowEditForm:function(t){},showEditFormDialog:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.isAdd=!1,t&&(this.resetForm=JSON.parse(JSON.stringify(this.form)),this.form=JSON.parse(JSON.stringify(t))),this.beforeShowEditForm(t),this.dialog=!0},addMethod:function(){var t=this;this.crudMethod.add(this.form).then((function(){t.addSuccessNotify(),t.loading=!1,t.afterAddMethod(),t.cancel(),t.init()})).catch((function(){t.loading=!1,t.afterAddErrorMethod()}))},afterAddMethod:function(){},afterAddErrorMethod:function(){},editMethod:function(){var t=this;this.crudMethod.edit(this.form).then((function(){t.editSuccessNotify(),t.loading=!1,t.afterEditMethod(),t.cancel(),t.init()})).catch((function(){t.loading=!1}))},afterEditMethod:function(){},beforeSubmitMethod:function(){return!0},submitMethod:function(){var t=this;this.beforeSubmitMethod()&&this.$refs["form"]&&this.$refs["form"].validate((function(e){e&&(t.loading=!0,t.isAdd?t.addMethod():t.editMethod())}))},cancel:function(){this.dialog=!1,this.$refs["form"]&&(this.$refs["form"].clearValidate(),this.form=this.resetForm)},getFormTitle:function(){return this.isAdd?"新增".concat(this.title):"编辑".concat(this.title)}}}},5723:function(t,e,i){"use strict";var a=i("b775"),o=i("720d"),s=i.n(o),r="MFwwDQYJKoZIhvcNAQEBBQADSwAwSAJBAN4UOrkIuLpL0o7WItgIUkP/RFBsurMPQ7fTaOKwT+S9tWly0xMmJzSl9Kdh8MpWcyz+5nUSb7SgGWxiE3qIL2sCAwEAAQ==";function n(t){var e=new s.a;return e.setPublicKey(r),e.encrypt(t)}var l={updatePass:function(t){var e={oldPassword:n(t.oldPassword),newPassword:n(t.newPassword),confirmPassword:n(t.confirmPassword)};return Object(a["a"])({url:"/account/change-password",method:"post",data:e})},resetEmailSend:function(t){return Object(a["a"])({url:"/reset/email-send?email="+t,method:"post"})},updateEmail:function(t){var e={password:n(t.pass),email:t.email};return Object(a["a"])({url:"/account/change-email/"+t.code,method:"post",data:e})},updateAvatar:function(t){return Object(a["a"])({url:"/account/change-avatar",method:"post",params:{avatar:t}})}};e["a"]=l},"5f87":function(t,e,i){"use strict";i.d(e,"a",(function(){return l})),i.d(e,"b",(function(){return c}));var a=i("a78e"),o=i.n(a),s=i("83d6"),r=i.n(s),n=r.a.TokenKey;function l(){return o.a.get(n)}function c(){return o.a.get("XSRF-TOKEN")}},"7e1e":function(t,e,i){"use strict";i.d(e,"a",(function(){return r}));var a=i("b775"),o=i("4328"),s=i.n(o);function r(t,e){return Object(a["a"])({url:t+"?"+s.a.stringify(e,{indices:!1}),method:"get"})}},8463:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"app-container"},[i("el-row",{attrs:{gutter:20}},[i("el-col",{staticStyle:{"margin-bottom":"10px"},attrs:{lg:6,md:8,sm:24,xl:5,xs:24}},[i("el-card",{staticClass:"box-card"},[i("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[i("span",[t._v("个人信息")])]),t._v(" "),i("div",[i("div",{staticStyle:{"text-align":"center"}},[i("div",{staticClass:"el-upload"},[i("img",{staticClass:"avatar",attrs:{src:t.user.avatar?t.baseApi+t.user.avatar:t.Avatar,title:"点击上传头像"},on:{click:t.toggleShow}}),t._v(" "),i("myUpload",{attrs:{field:"file",headers:t.headers,url:t.fileUploadApi},on:{"crop-upload-success":t.cropUploadSuccess},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}})],1)]),t._v(" "),i("ul",{staticClass:"user-info"},[i("li",[i("div",{staticStyle:{height:"100%"}},[i("svg-icon",{attrs:{"icon-class":"login"}}),t._v("\n                登录账号\n                "),i("div",{staticClass:"user-right"},[t._v(t._s(t.user.username))])],1)]),t._v(" "),i("li",[i("svg-icon",{attrs:{"icon-class":"user1"}}),t._v("\n              用户昵称\n              "),i("div",{staticClass:"user-right"},[t._v(t._s(t.user.nickname))])],1),t._v(" "),i("li",[i("svg-icon",{attrs:{"icon-class":"dept"}}),t._v("\n              所属部门\n              "),i("div",{staticClass:"user-right"},[t._v(" "+t._s(t.user.deptName))])],1),t._v(" "),i("li",[i("svg-icon",{attrs:{"icon-class":"phone"}}),t._v("\n              手机号码\n              "),i("div",{staticClass:"user-right"},[t._v(t._s(t.user.phone))])],1),t._v(" "),i("li",[i("svg-icon",{attrs:{"icon-class":"email"}}),t._v("\n              用户邮箱\n              "),i("div",{staticClass:"user-right"},[t._v(t._s(t.user.email))])],1),t._v(" "),i("li",[i("svg-icon",{attrs:{"icon-class":"anq"}}),t._v("\n              安全设置\n              "),i("div",{staticClass:"user-right"},[i("a",{on:{click:function(e){t.$refs.pass.dialog=!0}}},[t._v("修改密码")]),t._v(" "),i("a",{on:{click:function(e){t.$refs.email.dialog=!0}}},[t._v("修改邮箱")])])],1)])])])],1),t._v(" "),i("el-col",{attrs:{lg:18,md:16,sm:24,xl:19,xs:24}},[i("el-card",{staticClass:"box-card"},[i("el-tabs",{on:{"tab-click":t.handleClick},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[i("el-tab-pane",{attrs:{label:"用户资料",name:"first"}},[i("el-form",{ref:"form",staticStyle:{"margin-top":"10px"},attrs:{model:t.form,rules:t.rules,"label-width":"65px",size:"small"}},[i("el-form-item",{attrs:{label:"昵称",prop:"nickName"}},[i("el-input",{staticStyle:{width:"35%"},model:{value:t.form.nickname,callback:function(e){t.$set(t.form,"nickname",e)},expression:"form.nickname"}}),t._v(" "),i("span",{staticStyle:{color:"#C0C0C0","margin-left":"10px"}},[t._v("用户昵称不作为登录使用")])],1),t._v(" "),i("el-form-item",{attrs:{label:"手机号",prop:"phone"}},[i("el-input",{staticStyle:{width:"35%"},model:{value:t.form.phone,callback:function(e){t.$set(t.form,"phone",e)},expression:"form.phone"}}),t._v(" "),i("span",{staticStyle:{color:"#C0C0C0","margin-left":"10px"}},[t._v("手机号码不能重复")])],1),t._v(" "),i("el-form-item",{attrs:{label:"备注",prop:"description"}},[i("el-input",{staticStyle:{width:"35%"},attrs:{type:"textarea"},model:{value:t.form.description,callback:function(e){t.$set(t.form,"description",e)},expression:"form.description"}})],1),t._v(" "),i("el-form-item",{attrs:{label:""}},[i("el-button",{attrs:{loading:t.saveLoading,size:"mini",type:"primary"},on:{click:t.doSubmit}},[t._v("保存配置")])],1)],1)],1),t._v(" "),i("el-tab-pane",{attrs:{label:"操作日志",name:"second"}},[i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.data}},[i("el-table-column",{attrs:{label:"行为"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                  "+t._s(e.row.title)+"\n                ")]}}])}),t._v(" "),i("el-table-column",{attrs:{label:"IP",prop:"ipAddress"}}),t._v(" "),i("el-table-column",{attrs:{"show-overflow-tooltip":!0,label:"IP来源",prop:"ipLocation"}}),t._v(" "),i("el-table-column",{attrs:{label:"浏览器",prop:"browser"}}),t._v(" "),i("el-table-column",{attrs:{align:"center",label:"请求耗时",prop:"time"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.time<=300?i("el-tag",[t._v(t._s(e.row.time)+"ms")]):e.row.time<=1e3?i("el-tag",{attrs:{type:"warning"}},[t._v(t._s(e.row.time)+"ms")]):i("el-tag",{attrs:{type:"danger"}},[t._v(t._s(e.row.time)+"ms")])]}}])}),t._v(" "),i("el-table-column",{attrs:{align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",[t._v(t._s(t.parseTime(e.row.createdDate)))])]}}])},[i("template",{slot:"header"},[i("div",{staticStyle:{display:"inline-block",float:"right",cursor:"pointer"},on:{click:t.init}},[t._v("创建日期"),i("i",{staticClass:"el-icon-refresh",staticStyle:{"margin-left":"40px"}})])])],2)],1),t._v(" "),i("el-pagination",{staticStyle:{"margin-top":"8px"},attrs:{"current-page":t.page+1,total:t.total,layout:"total, prev, pager, next, sizes"},on:{"current-change":t.pageChange,"size-change":t.sizeChange}})],1)],1)],1)],1)],1),t._v(" "),i("updateEmail",{ref:"email",attrs:{email:t.user.email}}),t._v(" "),i("updatePass",{ref:"pass"})],1)},o=[],s=(i("7f7f"),i("5530")),r=i("0b4d"),n=i("2f62"),l=i("91f0"),c=i("c44d"),d=i("5f87"),u=i("4360"),f=i("61f7"),m=i("cf45"),h=i("3cdc"),p=i("d1e5"),g=i("4d41"),v=i.n(g),b=i("5723"),w=m["a"].parseTime,y={name:"Center",components:{updatePass:l["default"],updateEmail:c["default"],myUpload:r["a"]},mixins:[h["a"]],data:function(){var t=function(t,e,i){e?f["a"].isvalidPhone(e)?i():i(new Error("请输入正确的11位手机号码")):i(new Error("请输入电话号码"))};return{show:!1,Avatar:v.a,activeName:"first",saveLoading:!1,headers:{"X-XSRF-TOKEN":Object(d["b"])()},form:{},rules:{nickname:[{required:!0,message:"请输入用户昵称",trigger:"blur"},{min:2,max:20,message:"长度在 2 到 20 个字符",trigger:"blur"}],phone:[{required:!0,trigger:"blur",validator:t}]}}},computed:Object(s["a"])({},Object(n["b"])(["user","fileUploadApi","baseApi"])),created:function(){this.form={id:this.user.id,nickname:this.user.nickname,description:this.user.description,phone:this.user.phone},u["a"].dispatch("GetUser").then((function(){}))},methods:{parseTime:w,handleClick:function(t,e){"second"===t.name&&this.init()},beforeInit:function(){return this.url="/sys/log-operate/user",!0},toggleShow:function(){this.show=!this.show},cropUploadSuccess:function(t,e){b["a"].updateAvatar(t.data.fileName).then((function(){u["a"].dispatch("GetUser").then((function(){}))}))},doSubmit:function(){var t=this;this.$refs["form"]&&this.$refs["form"].validate((function(e){e&&(t.saveLoading=!0,p["default"].saveInfo(t.form).then((function(){u["a"].dispatch("GetUser").then((function(){})),t.saveLoading=!1})).catch((function(){t.saveLoading=!1})))}))}}},_=y,S=(i("e31b"),i("2877")),x=Object(S["a"])(_,a,o,!1,null,null,null);e["default"]=x.exports},"91f0":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticStyle:{display:"inline-block"}},[i("el-dialog",{attrs:{"before-close":t.cancel,"close-on-click-modal":!1,title:t.title,visible:t.dialog,"append-to-body":"",width:"500px"},on:{"update:visible":function(e){t.dialog=e},close:t.cancel}},[i("el-form",{ref:"form",attrs:{model:t.form,rules:t.rules,"label-width":"88px",size:"small"}},[i("el-form-item",{attrs:{label:"旧密码",prop:"oldPassword"}},[i("el-input",{staticStyle:{width:"370px"},attrs:{"auto-complete":"on",type:"password"},model:{value:t.form.oldPassword,callback:function(e){t.$set(t.form,"oldPassword",e)},expression:"form.oldPassword"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"新密码",prop:"newPassword"}},[i("el-input",{staticStyle:{width:"370px"},attrs:{"auto-complete":"on",type:"password"},model:{value:t.form.newPassword,callback:function(e){t.$set(t.form,"newPassword",e)},expression:"form.newPassword"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"确认密码",prop:"confirmPassword"}},[i("el-input",{staticStyle:{width:"370px"},attrs:{"auto-complete":"on",type:"password"},model:{value:t.form.confirmPassword,callback:function(e){t.$set(t.form,"confirmPassword",e)},expression:"form.confirmPassword"}})],1)],1),t._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"text"},on:{click:t.cancel}},[t._v("取消")]),t._v(" "),i("el-button",{attrs:{loading:t.loading,type:"primary"},on:{click:t.doSubmit}},[t._v("确认")])],1)],1)],1)},o=[],s=i("4360"),r=i("5723"),n={data:function(){var t=this,e=function(e,i,a){i?t.form.newPassword!==i?a(new Error("两次输入的密码不一致")):a():a(new Error("请再次输入密码"))};return{loading:!1,dialog:!1,title:"修改密码",form:{oldPassword:"",newPassword:"",confirmPassword:""},rules:{oldPassword:[{required:!0,message:"请输入旧密码",trigger:"blur"}],newPassword:[{required:!0,message:"请输入新密码",trigger:"blur"},{min:6,max:20,message:"长度在 6 到 20 个字符",trigger:"blur"}],confirmPassword:[{required:!0,validator:e,trigger:"blur"}]}}},methods:{cancel:function(){this.resetForm()},doSubmit:function(){var t=this;this.$refs["form"].validate((function(e){if(!e)return!1;t.loading=!0,r["a"].updatePass(t.form).then((function(e){t.resetForm(),setTimeout((function(){s["a"].dispatch("LogOut").then((function(){location.reload()}))}),500)})).catch((function(e){t.loading=!1}))}))},resetForm:function(){this.dialog=!1,this.$refs["form"].resetFields(),this.form={oldPassword:"",newPassword:"",confirmPassword:""}}}},l=n,c=i("2877"),d=Object(c["a"])(l,a,o,!1,null,"502d9fec",null);e["default"]=d.exports},c44d:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticStyle:{display:"inline-block"}},[i("el-dialog",{attrs:{"before-close":t.cancel,"close-on-click-modal":!1,title:t.title,visible:t.dialog,"append-to-body":"",width:"475px"},on:{"update:visible":function(e){t.dialog=e},close:t.cancel}},[i("el-form",{ref:"form",attrs:{model:t.form,rules:t.rules,"label-width":"88px",size:"small"}},[i("el-form-item",{attrs:{label:"新邮箱",prop:"email"}},[i("el-input",{staticStyle:{width:"200px"},attrs:{"auto-complete":"on"},model:{value:t.form.email,callback:function(e){t.$set(t.form,"email",e)},expression:"form.email"}}),t._v(" "),i("el-button",{attrs:{disabled:t.isDisabled,loading:t.codeLoading,size:"small"},on:{click:t.sendCode}},[t._v(t._s(t.buttonName)+"\n        ")])],1),t._v(" "),i("el-form-item",{attrs:{label:"验证码",prop:"code"}},[i("el-input",{staticStyle:{width:"320px"},model:{value:t.form.code,callback:function(e){t.$set(t.form,"code",e)},expression:"form.code"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"当前密码",prop:"pass"}},[i("el-input",{staticStyle:{width:"320px"},attrs:{type:"password"},model:{value:t.form.pass,callback:function(e){t.$set(t.form,"pass",e)},expression:"form.pass"}})],1)],1),t._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"text"},on:{click:t.cancel}},[t._v("取消")]),t._v(" "),i("el-button",{attrs:{loading:t.loading,type:"primary"},on:{click:t.doSubmit}},[t._v("确认")])],1)],1)],1)},o=[],s=i("4360"),r=i("61f7"),n=i("5723"),l={props:{email:{type:String,required:!0}},data:function(){var t=this,e=function(e,i,a){""===i||null===i?a(new Error("新邮箱不能为空")):i===t.email?a(new Error("新邮箱不能与旧邮箱相同")):r["a"].validEmail(i)?a():a(new Error("邮箱格式错误"))};return{loading:!1,dialog:!1,title:"修改邮箱",form:{pass:"",email:"",code:""},user:{email:"",password:""},codeLoading:!1,buttonName:"获取验证码",isDisabled:!1,time:60,rules:{pass:[{required:!0,message:"当前密码不能为空",trigger:"blur"}],email:[{required:!0,validator:e,trigger:"blur"}],code:[{required:!0,message:"验证码不能为空",trigger:"blur"}]}}},methods:{cancel:function(){this.resetForm()},sendCode:function(){var t=this;if(this.form.email&&this.form.email!==this.email){this.codeLoading=!0,this.buttonName="验证码发送中";var e=this;n["a"].resetEmailSend(this.form.email).then((function(i){t.$message({showClose:!0,message:"发送成功，验证码有效期5分钟",type:"success"}),t.codeLoading=!1,t.isDisabled=!0,t.buttonName=t.time--+"秒后重新发送",t.timer=window.setInterval((function(){e.buttonName=e.time+"秒后重新发送",--e.time,e.time<0&&(e.buttonName="重新发送",e.time=60,e.isDisabled=!1,window.clearInterval(e.timer))}),1e3)})).catch((function(e){t.resetForm(),t.codeLoading=!1}))}else this.$message({message:"邮箱不能为空",type:"warning"})},doSubmit:function(){var t=this;this.$refs["form"].validate((function(e){if(!e)return!1;t.loading=!0,n["a"].updateEmail(t.form).then((function(e){t.loading=!1,t.resetForm(),s["a"].dispatch("GetUser").then((function(){}))})).catch((function(e){t.loading=!1}))}))},resetForm:function(){this.dialog=!1,this.$refs["form"].resetFields(),window.clearInterval(this.timer),this.time=60,this.buttonName="获取验证码",this.isDisabled=!1,this.form={pass:"",email:"",code:""}}}},c=l,d=i("2877"),u=Object(d["a"])(c,a,o,!1,null,"d6ab5358",null);e["default"]=u.exports},d1e5:function(t,e,i){"use strict";i.r(e),i.d(e,"save",(function(){return r})),i.d(e,"saveInfo",(function(){return n})),i.d(e,"del",(function(){return l})),i.d(e,"page",(function(){return c})),i.d(e,"get",(function(){return d})),i.d(e,"lock",(function(){return u})),i.d(e,"download",(function(){return f}));var a=i("b775"),o=i("4328"),s=i.n(o);function r(t){return Object(a["a"])({url:"/sys/user/",method:"post",data:t})}function n(t){return Object(a["a"])({url:"/sys/user/info",method:"post",data:t})}function l(t){return Object(a["a"])({url:"/sys/user/",method:"delete",data:t})}function c(t){return Object(a["a"])({url:"/sys/user/?"+s.a.stringify(t,{indices:!1}),method:"get"})}function d(t){return Object(a["a"])({url:"/sys/user/"+t,method:"get"})}function u(t){return Object(a["a"])({url:"/sys/user/",method:"put",data:t})}function f(t){return Object(a["a"])({url:"/sys/user/download?"+s.a.stringify(t,{indices:!1}),method:"get",responseType:"blob"})}e["default"]={page:c,save:r,lock:u,del:l,get:d,download:f,saveInfo:n}},e31b:function(t,e,i){"use strict";i("30c4")}}]);