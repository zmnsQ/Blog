(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-df09db26"],{"00a2":function(t,e,n){"use strict";n("971e")},"28e4":function(t,e,n){"use strict";n.r(e),n.d(e,"cameraList",(function(){return o})),n.d(e,"Tree",(function(){return r})),n.d(e,"initInfo",(function(){return s}));var i=n("b775");function o(t){return Object(i["a"])({url:"/api/resourceCameraUrls",method:"get",params:t})}function r(t){return Object(i["a"])({url:"/api/resource/Tree",method:"get"})}function s(){return Object(i["a"])({url:"/api/Initkey",method:"get"})}e["default"]={cameraList:o,Tree:r,initInfo:s}},"71c3":function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"app-container",staticStyle:{padding:"0"}},[n("el-row",[n("el-col",{attrs:{lg:4,md:4,sm:6,xl:4,xs:9}},[n("hk-tree",{on:{eventnode:t.videoPreview}})],1),t._v(" "),n("el-col",{attrs:{id:"videoMaincontent1",lg:20,md:20,sm:18,xl:20,xs:15}},[n("div",{staticClass:"playWnd",style:{width:t.swfWidth+"px",height:t.swfHeight+"px"},attrs:{id:"playWnd"}})])],1)],1)},o=[],r=(n("a481"),n("1157")),s=n.n(r),a=n("cfe4"),l=n("28e4"),c={name:"Camera",components:{HkTree:a["default"]},data:function(){return{swfHeight:"",swfWidth:"",initCount:0,initparam:{appKey:"",secret:"",apiIp:"",apiPort:443,layout:"2x2"},wndId:1,pointCode:"",pubKey:"",oWebControl:null,WebControl:null}},created:function(){this.getInitParam()},beforeMount:function(){this.WebControl=WebControl},mounted:function(){var t=this;this.swfHeight=s()(window).height()-111,this.swfWidth=document.getElementById("videoMaincontent1").offsetWidth,this.initPlugin(),window.onresize=function(){return function(){t.swfHeight=s()(window).height()-111,t.swfWidth=document.getElementById("videoMaincontent1").offsetWidth,null!=t.oWebControl&&(t.oWebControl.JS_Resize(t.swfWidth,t.swfHeight),t.setWndCover())}()},s()(window).scroll((function(){null!=t.oWebControl&&(t.oWebControl.JS_Resize(t.swfWidth,t.swfHeight),t.setWndCover())}))},beforeDestroy:function(){this.closeWindow(),window.onresize=null},methods:{getInitParam:function(){var t=this;l["default"].initInfo().then((function(e){t.initparam=e.data,t.init()}))},videoPreview:function(t){this.oWebControl.JS_ShowWnd(),this.pointCode=t,this.startpreview()},initPlugin:function(){var t=this;this.oWebControl=new WebControl({szPluginContainer:"playWnd",iServicePortStart:15900,iServicePortEnd:15909,szClassId:"23BF3B0A-2C56-4D97-9C03-0CB103AA8F11",cbConnectSuccess:function(){t.initCount=0,t.oWebControl.JS_StartService("window",{dllPath:"./VideoPluginConnect.dll"}).then((function(){t.oWebControl.JS_SetWindowControlCallback({cbIntegrationCallBack:t.cbIntegrationCallBack}),t.oWebControl.JS_CreateWnd("playWnd",t.swfWidth,t.swfHeight).then((function(){t.init()}))}),(function(){}))},cbConnectError:function(){t.oWebControl=null,s()("#playWnd").html("<p>&nbsp;插件未启动，正在尝试启动，请稍候...</p>"),t.WebControl.JS_WakeUp("VideoWebPlugin://"),t.initCount++,t.initCount<3?setTimeout((function(){t.initPlugin()}),3e3):s()("#playWnd").html('<p>&nbsp;插件启动失败，请安装插件!</p><a style="color:#0c5890" href="../VideoWebPlugin.exe" download="VideoWebPlugin.exe" >下载地址</a>')},cbConnectClose:function(e){t.oWebControl=null}})},setCallbacks:function(){this.oWebControl.JS_SetWindowControlCallback({cbIntegrationCallBack:this.cbIntegrationCallBack})},cbIntegrationCallBack:function(t){this.wndId=t.responseMsg.msg.wndId},init:function(){var t=this;this.getPubKey((function(){var e=t.initparam.appKey,n=t.setEncrypt(t.initparam.secret),i=t.initparam.apiIp,o=t.initparam.apiPort;o=parseInt(o);var r=t.initparam.layout,s=0,a="D:\\SnapDir",l="D:\\VideoDir",c=1,u="secret",d=1,h=0,f="0,16,256,257,258,259,260,512,513,514,515,516,517,768,769";t.oWebControl.JS_RequestInterface({funcName:"init",argument:JSON.stringify({appkey:e,secret:n,ip:i,playMode:s,port:o,snapDir:a,videoDir:l,layout:r,enableHTTPS:c,encryptedFields:u,showToolbar:d,showSmart:h,buttonIDs:f})}).then((function(e){t.oWebControl.JS_Resize(t.swfWidth,t.swfHeight)}))}))},getPubKey:function(t){var e=this;this.oWebControl.JS_RequestInterface({funcName:"getRSAPubKey",argument:JSON.stringify({keyLength:1024})}).then((function(n){n.responseMsg.data&&(e.pubKey=n.responseMsg.data,t())}))},setEncrypt:function(t){var e=new JSEncrypt;return e.setPublicKey(this.pubKey),e.encrypt(t)},setWndCover:function(){var t=s()(window).width(),e=s()(window).height(),n=s()("#playWnd").get(0).getBoundingClientRect(),i=n.left<0?Math.abs(n.left):0,o=n.top<0?Math.abs(n.top):0,r=n.right-t>0?Math.round(n.right-t):0,a=n.bottom-e>0?Math.round(n.bottom-e):0;i=i>this.swfWidth?this.swfWidth:i,o=o>this.swfHeight?this.swfHeight:o,r=r>this.swfWidth?this.swfWidth:r,a=a>this.swfHeight?this.swfHeight:a,this.oWebControl.JS_RepairPartWindow(0,0,this.swfWidth+1,this.swfHeight),0!==i&&this.oWebControl.JS_CuttingPartWindow(0,0,i,this.swfHeight),0!==o&&this.oWebControl.JS_CuttingPartWindow(0,0,this.swfWidth+1,o),0!==r&&this.oWebControl.JS_CuttingPartWindow(this.swfWidth-r,0,r,this.swfHeight),0!==a&&this.oWebControl.JS_CuttingPartWindow(0,this.swfHeight-a,this.swfWidth,a)},startpreview:function(){var t=this.pointCode,e=t,n=0,i=1,o=0,r=this.wndId;e=e.replace(/(^\s*)/g,""),e=e.replace(/(\s*$)/g,""),this.oWebControl.JS_RequestInterface({funcName:"startPreview",argument:JSON.stringify({cameraIndexCode:e,streamMode:n,transMode:i,gpuMode:o,wndId:r})})},stopAllPreview:function(){this.oWebControl.JS_RequestInterface({funcName:"stopAllPreview"})},closeWindow:function(){null!=this.oWebControl&&(this.oWebControl.JS_HideWnd(),this.oWebControl.JS_Disconnect().then((function(){}),(function(){})))}}},u=c,d=n("2877"),h=Object(d["a"])(u,i,o,!1,null,"37abcf16",null);e["default"]=h.exports},"971e":function(t,e,n){},cfe4:function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"hk-tree"}},[n("div",{staticClass:"tree-title"},[t._v("监控点")]),t._v(" "),n("el-tree",{attrs:{data:t.treeData,"icon-class":t.treeData.icon},on:{"node-click":t.handleNodeClick},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.node,o=e.data;return n("span",{staticClass:"custom-tree-node"},[n("span",[n("i",{class:[o.icon,"tree-icon"]}),t._v(" "),n("span",[t._v(t._s(i.label))])])])}}])})],1)},o=[],r=n("28e4"),s={data:function(){return{treeData:[],treeClickCount:0}},created:function(){var t=this;r["default"].Tree().then((function(e){t.treeData.push(e.data)}))},methods:{handleNodeClick:function(t,e){var n=this;this.treeClickCount++,this.treeClickCount>=2||(this.timer=window.setTimeout((function(){1===n.treeClickCount?n.treeClickCount=0:n.treeClickCount>1&&(n.treeClickCount=0,n.$emit("eventnode",t.cameraIndexCode))}),300))}}},a=s,l=(n("00a2"),n("2877")),c=Object(l["a"])(a,i,o,!1,null,"64c46382",null);e["default"]=c.exports}}]);